<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <title>Test</title>
</head>
<body>
<div id='test'>
  <div>
    hello world~
  </div>
  <div>hello world2
    <div>
      hello world3
      hello world4
    </div>
  </div>
</div>
</body>
<script>
  const el = document.getElementById('test');
  const isFunction = (f) => typeof f === 'function';
  const getScore = (element, depth, exist, ignoreTags) => {
    if (!element || ignoreTags.indexOf(element.tagName) > -1) {
      return 0;
    }

    const { children = [] } = element;
    const tmp = [].slice.call(children);
    const score = tmp.reduceRight((sum, child) => {
      return sum + getScore(child, depth + 1, sum > 0, ignoreTags);
    }, 0);

    if (score <= 0 && !exist) {
      if (!isFunction(element.getBoundingClientRect)) {
        return 0;
      }

      const { top, height } = element.getBoundingClientRect() || {};
      if (top > window.innerHeight || height <= 0) {
        return 0;
      }
    }

    return score + 1 + 0.5 * depth;
  };
  console.log(getScore(el, 0, false, []));
</script>
</html>
